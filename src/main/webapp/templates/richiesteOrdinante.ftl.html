<!-- Page body -->
<div class="page-body">
  <div class="container-xl">
    <div class="row row-cards">
      <h1>Le tue richieste</h1>
    
      <div class="col-12">
        <div class="card">
          <div class="table-responsive">
            <table class="table card-table table-vcenter text-nowrap datatable">
              <thead>
                <tr>
                  <th class="w-1 text-center">Codice</th>
                  <th class="text-center">Categoria</th>
                  <th class="text-center">Ordinante</th>
                  <th class="text-center">Tecnico</th>
                  <th class="text-center">Data</th>
                  <th class="text-center">Stato</th>
                  
                  <th class="text-end">Azioni</th>
                </tr>
              </thead>
              <tbody>
                <#-- Ciclo su tutte le richieste passate dalla Servlet -->
                <#list richieste as r>
                  <tr>
                    <!-- Codice richiesta -->
                    <td class="text-center">
                      <span class="text-secondary">${r.codiceRichiesta}</span>
                    </td>

                    <!-- Categoria (eventualmente r.categoria.nome se Categoria Ã¨ un oggetto) -->
                    <td class="text-center">
                      <span>${r.categoria.nome}</span>
                    </td>

                    <!-- Ordinante  -->
                    <td class="text-center">
                      <span>
                        ${r.ordinante.getUsername()} 
                      </span>
                    </td>

                    <!-- Tecnico (se assegnato) -->
                    <td class="text-center">
                      <#if r.tecnico??>
                        <span>
                          ${r.tecnico.getUsername()} 
                        </span>
                      <#else>
                        <span>Nessun tecnico assegnato</span>
                      </#if>
                    </td>

                    <!-- Data -->
                    <td class="text-center">
                      <span>${r.data}</span>
                    </td>

                    <!-- Stato con pallino colorato in base al valore -->
                    <td class="text-center">
                      <#if r.stato?string == "RISOLTA">
                        <span class="badge bg-success me-1"></span>Risolta
                      <#elseif r.stato?string == "PRESA_IN_CARICO">
                        <span class="badge bg-warning me-1"></span>Presa in carico
                      <#elseif r.stato?string == "ORDINATA">
                        <span class="badge bg-orange me-1"></span>Ordinata
                      <#elseif r.stato?string == "IN_ATTESA">
                        <span class="badge bg-danger me-1"></span>In attesa
                      <#else>
                        <span class="badge bg-secondary me-1"></span>Sconosciuto
                      </#if>
                    </td>

                   

                    <!--  link a pagina di dettaglio -->
                    <td class="text-end">
                      <span class="dropdown">
                        <a href="DettaglioRichiesta?id=${r.id}" class="btn btn-light active">Visualizza</a>
                      </span>
                    </td>
                  </tr>
                </#list>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
